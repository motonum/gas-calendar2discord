# Googleカレンダーの予定をDiscordに通知するスクリプト

## 概要

このスクリプトは、Google Apps Script（GAS）を使い、Googleカレンダーの予定を毎日決まった時間にDiscordチャンネルへ通知するためのものです。月曜日には、その週1週間分の予定をまとめて通知します。

## 主な機能

-   **毎日の予定通知**: 指定した時間に、その日の予定一覧をDiscordに送信します。
-   **週次の予定まとめ**: 毎週月曜日に、その週の予定一覧をまとめてDiscordに送信します。
-   **簡単な設定**: スクリプトをコピーし、いくつかの設定を行うだけで利用を開始できます。

## 導入方法

プログラミングに詳しくない方でも分かるように、導入手順を説明します。

### ステップ1: Google Apps Scriptの準備

1.  [Google Apps Script](https://script.google.com/home) にアクセスし、Googleアカウントでログインします。
2.  「新しいプロジェクト」をクリックして、スクリプトエディタを開きます。
3.  エディタに最初から書かれているコード（`function myFunction() { ... }`）をすべて削除します。
4.  このリポジトリにある `main.js` ファイルの中身をすべてコピーし、エディタに貼り付けます。
5.  左上の「無題のプロジェクト」をクリックし、`Discord通知` のような分かりやすい名前を付けて「名前を変更」をクリックします。
6.  フロッピーディスクのアイコン（💾）をクリックして、プロジェクトを保存します。

### ステップ2: DiscordのWebhook URLを取得する

1.  通知を送りたいDiscordチャンネルの歯車アイコン（⚙️）をクリックし、「連携サービス」を選択します。
2.  「ウェブフック」をクリックし、「新しいウェブフック」ボタンを押します。
3.  作成されたウェブフック（例: Spidey Bot）の名前やアイコンを自由に変更できます。
4.  「ウェブフックURLをコピー」をクリックして、URLを控えておきます。**このURLは他人に教えないでください。**

### ステップ3: GoogleカレンダーIDを取得する

1.  通知したい予定が登録されている [Googleカレンダー](https://calendar.google.com/) を開きます。
2.  左側のカレンダー一覧から、対象のカレンダーの右側にある「︙」をクリックし、「設定と共有」を選択します。
3.  「カレンダーの統合」という項目までスクロールします。
4.  `カレンダーID` という欄にあるメールアドレス形式のID（例: `xxxxxxxx@group.calendar.google.com`）をコピーして、控えておきます。

### ステップ4: スクリプトの設定を行う

1.  先ほど開いたGoogle Apps Scriptのエディタ画面に戻ります。
2.  左側のメニューから歯車アイコン（⚙️）の「プロジェクトの設定」をクリックします。
3.  「スクリプト プロパティ」というセクションにある「スクリプト プロパティを追加」をクリックします。
4.  以下の2つのプロパティを追加します。
    -   **プロパティ1**
        -   `プロパティ`: `DISCORD_WEBHOOK_URL`
        -   `値`: ステップ2でコピーしたDiscordのWebhook URL
    -   **プロパティ2**
        -   `プロパティ`: `CALENDAR_ID`
        -   `値`: ステップ3でコピーしたカレンダーID
5.  「スクリプト プロパティを保存」をクリックします。

### ステップ5: 通知の自動実行を設定する

最後に、毎日自動で通知が送られるように設定します。

1.  Google Apps Scriptのエディタ画面上部にある `main` と表示されている関数選択メニューをクリックし、`initTrigger` を選択します。
2.  「実行」ボタンをクリックします。
3.  初めて実行する際に「承認が必要です」という画面が表示されます。
    -   「権限を確認」をクリックします。
    -   自分のGoogleアカウントを選択します。
    -   「このアプリはGoogleで確認されていません」という警告が出たら、「詳細」をクリックします。
    -   左下に表示される「（プロジェクト名）（安全ではないページ）に移動」をクリックします。
    -   「許可」をクリックします。
4.  「実行ログ」にエラーが表示されなければ、設定は成功です。

これで全てのセットアップは完了です！毎日、スクリプトで設定した時間にDiscordへ通知が届くようになります。

## カスタマイズ（任意）

スクリプトの冒頭部分を編集することで、通知のタイミングを調整できます。

-   `NOTIFICATION_HOUR`: 通知を送る時間（0〜23時で指定）
    -   例: `const NOTIFICATION_HOUR = 9;` // 午前9時に通知
-   `WEEKLY_NOTIFICATION_DAY`: 週のまとめを送る曜日（0:日曜, 1:月曜, ... 6:土曜）
    -   例: `const WEEKLY_NOTIFICATION_DAY = 0;` // 日曜日に週のまとめを通知

編集した後は、忘れずにプロジェクトを保存（💾）してください。
